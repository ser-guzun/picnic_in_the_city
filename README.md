# Пикник в городе
Приложение для планирование пикника в городах. 

## Описание
Приложение позволяет планировать пикники в городе. 
В приложение имеются следующие сущности:
- город
- пользователь
- пикник

## Запуск
Запуск возможен следующими способами:
- вообще без использования docker
- приложение без docker, БД в docker
- приложение и БД в docker-контейнерах

БД всегда запускается в docker-контейнере.

### 1. Запуск приложения без docker.
Запустить БД в docker-контейнере командой:
```bash
doker-compose up -d db
```
_Примечание_: если у глобально вас установлен `PostgreSQL`, то он крутится на `5432` порту. 
Тогда вам нужно в файле `docker-compose.yaml` изменить `внутренний` порт контейнера для `db` на любой другой свободный.

Для связи с БД в docker-контейнере нужно задать в переменных окружения (файл `.env`):
```bash
POSTGRES_SERVER=localhost
```
Для связи с БД в docker-контейнере библиотеки, управляющей миграциями (в нашем случае `alembic`) в файле `alembic.ini` задать:
```bash
sqlalchemy.url = postgresql+asyncpg://user:pass@localhost:5432/dbname
```
После запуска БД в docker-контейнере необходимо накатить миграции командой:
```bash
alembic upgrade head
```
Теперь можно запускать приложение, но делать это нужно через настроенную конфигурацию в PyCharm) 
Если это делать через консоль командой:
```bash
uvicorn --host localhost --port 8000 src.main:app --reload
```
то будут ошибки. Хотя их за 30 минут и можно исправить. 

### 2. Запуск с помощью docker.
Запустить БД в docker-контейнере командой:
```bash
doker-compose up -d db
```
_Примечание_: если у глобально вас установлен PostgreSQL, то он крутится на 5432 порту. 
Тогда вам нужно в файле `docker-compose.yaml` изменить `внутренний` порт контейнера для `db` на любой другой свободный.

Для связи с БД в docker-контейнере нужно задать в переменных окружения (файл `.env`):
```bash
POSTGRES_SERVER=db
```
Для связи с БД в docker-контейнере библиотеки, управляющей миграциями (в нашем случае `alembic`) в файле `alembic.ini` задать:
```bash
sqlalchemy.url = postgresql+asyncpg://user:pass@db:5432/dbname
```
Запустить приложение в docker-контейнере командой:
```bash
doker-compose up -d app
```


## Старт
http://localhost:8000/
